# Итоговое описание проекта

## Что было создано

Полноценная система автоматической коррекции сайтов на основе Astro с использованием нейросетевой детекции объектов и ChatGPT API.

## Структура проекта

### Основные компоненты

1. **API Server (FastAPI)**
   - `app/main.py` - Главный файл приложения
   - `app/api/routes.py` - API маршруты
   - `app/models/schemas.py` - Модели данных (Pydantic)

2. **Сервисы**
   - `app/services/inference.py` - Детекция объектов через Detectron2
   - `app/services/chatgpt.py` - Интеграция с ChatGPT API для коррекции кода

3. **Утилиты**
   - `app/utils/html_parser.py` - Парсинг и обработка HTML

4. **Конфигурация**
   - `Dockerfile` - Docker образ
   - `docker-compose.yml` - Docker Compose конфигурация
   - `requirements.txt` - Python зависимости
   - `.env.example` - Пример переменных окружения

5. **Документация**
   - `README.md` - Основная документация
   - `QUICKSTART.md` - Быстрый старт
   - `DEPLOYMENT.md` - Руководство по развертыванию
   - `API_EXAMPLES.md` - Примеры использования API
   - `SYSTEM_DESCRIPTION.md` - Полное описание системы
   - `SETUP_MODEL.md` - Инструкция по настройке модели

## Как работает система

1. **Клиент отправляет JSON запрос** с Astro кодом страницы
2. **API сервер принимает запрос** и валидирует данные
3. **Генерируется скриншот** страницы (или используется существующий)
4. **Detectron2 выполняет детекцию** объектов на скриншоте
5. **ChatGPT анализирует результаты** и исправляет код
6. **Возвращается исправленный** Astro код с обновленными координатами

## Ключевые особенности

- ✅ Полностью контейнеризовано через Docker
- ✅ REST API на FastAPI
- ✅ Интеграция с Detectron2 для детекции объектов
- ✅ Интеграция с ChatGPT API для коррекции кода
- ✅ Автоматическая конвертация координат (пиксели → vw/vh)
- ✅ Сохранение существующих блоков (опционально)
- ✅ Полная документация
- ✅ Готово к развертыванию на сервере

## Быстрый старт

```bash
# 1. Настройка переменных окружения
cp .env.example .env
# Отредактируйте .env и укажите OPENAI_API_KEY

# 2. Размещение модели
cp /path/to/model_final.pth models/

# 3. Запуск
docker-compose up -d --build

# 4. Проверка
curl http://localhost:8000/api/v1/health
```

## API Endpoints

- `POST /api/v1/correct` - Коррекция Astro кода
- `GET /api/v1/health` - Проверка работоспособности
- `POST /api/v1/detect` - Только детекция объектов

## Требования

- Docker и Docker Compose
- OpenAI API ключ
- Обученная модель Detectron2 (model_final.pth)
- Конфигурация модели (config.yaml)

## Следующие шаги

1. Прочитайте `QUICKSTART.md` для быстрого старта
2. Настройте модель согласно `SETUP_MODEL.md`
3. Изучите примеры в `API_EXAMPLES.md`
4. Разверните на сервере по `DEPLOYMENT.md`

## Поддержка

Все файлы документации содержат подробные инструкции и примеры. При возникновении проблем проверьте логи через `docker-compose logs api`.
